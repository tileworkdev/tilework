@namespace Tilework.Ui.Components.Pages

@inject CertificateAuthorityListViewModel ViewModel
@inject NavigationManager NavigationManager


@page "/cm/authorities"

<GenericListview Title="ACME CAs" Items="@ViewModel.Objects" Actions="@_actions" Breadcrumbs="@_breadcrumbs">
    <HeaderContent>
        <MudTh>Name</MudTh>
        <MudTh>Email</MudTh>
        <MudTh>URL</MudTh>
    </HeaderContent>
    <RowContent>
        <MudTd DataLabel="Name"><MudLink Href="@DetailLink(context.Id)">@context.Name</MudLink></MudTd>
        <MudTd DataLabel="Email">@context.Email</MudTd>
        <MudTd DataLabel="URL">@context.DirectoryUrl</MudTd>
    </RowContent>
</GenericListview>

@code {
    private List<BreadcrumbItem> _breadcrumbs = new List<BreadcrumbItem>
    {
        new BreadcrumbItem("Home", href: "/", icon: Icons.Material.Filled.Home),
        new BreadcrumbItem("ACME CAs", href: "/cm/authorities/", disabled: true, icon: Icons.Material.Filled.AltRoute),
    };

    private List<ActionItem> _actions = new List<ActionItem>
    {
        new ActionItem { Name = "Create new", Href = "/cm/authorities/new" }
    };

    protected override async Task OnInitializedAsync()
    {
        await ViewModel.Initialize();
    }

    private string DetailLink(Guid Id)
    {
        return $"/cm/authorities/{Id.ToString()}";
    }
}    
