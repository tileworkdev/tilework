@using Tilework.Ui.Interfaces
@namespace Tilework.Ui.Components.Layout

@typeparam T

<MudBreadcrumbs Items="Breadcrumbs" Separator=">"></MudBreadcrumbs>

<MudTable T="T" Outlined="true" Items="@ViewModel.Items" Hover="true">
    <ToolBarContent>
        <MudText Typo="Typo.h6">@Title</MudText>
        <MudSpacer />
        @foreach(var action in Actions)
        {
            <MudButton Variant="Variant.Filled" DropShadow="false" Color="Color.Primary" Href="@action.Href">
                @action.Name
            </MudButton>
        }
    </ToolBarContent>
    <HeaderContent>
        @HeaderContent
    </HeaderContent>
    <RowTemplate>
        @if(RowContent != null)
        {
            @RowContent(context)
        }
    </RowTemplate>
</MudTable>

@code {
    [Parameter] public string Title { get; set; } = "";
    [Parameter] public IListViewModel<T> ViewModel { get; set; } = default!;
    [Parameter] public List<ActionItem> Actions { get; set; } = new List<ActionItem>();
    [Parameter] public List<BreadcrumbItem> Breadcrumbs { get; set; } = new List<BreadcrumbItem>();

    [Parameter] public RenderFragment? ActionContent { get; set; }
    [Parameter] public RenderFragment? HeaderContent { get; set; }
    [Parameter] public RenderFragment<T>? RowContent { get; set; }


    protected override async Task OnInitializedAsync()
    {
        await ViewModel.Initialize();
    }
}
