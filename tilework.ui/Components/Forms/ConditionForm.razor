@using Tilework.LoadBalancing.Enums
@using Tilework.LoadBalancing.Persistence.Models

@namespace Tilework.Ui.Components.Forms

<MudGrid Class="mb-4">
    <MudItem xs="4">
        <MudSelect T="ConditionType" @bind-Value="Condition.Type" Label="Condition type" Variant="Variant.Outlined" Required="true">
            <MudSelectItem Value="ConditionType.HostHeader">Host header</MudSelectItem>
            <MudSelectItem Value="ConditionType.Path">Path</MudSelectItem>
            <MudSelectItem Value="ConditionType.QueryString">Query string</MudSelectItem>
        </MudSelect>
    </MudItem>
    <MudItem xs="8">
        <MudStack Spacing="2">
            @for (var i = 0; i < Condition.Values.Count; i++)
            {
                var index = i;
                <MudStack Direction="Row" AlignItems="AlignItems.Center" Spacing="1">
                    <MudTextField @bind-Value="Condition.Values[index]" Label="Value" Variant="Variant.Outlined" Required="true" />
                    <MudIconButton Icon="@Icons.Material.Filled.Delete" Color="Color.Error" OnClick="@(() => RemoveValue(index))" />
                </MudStack>
            }
            <MudIconButton Icon="@Icons.Material.Filled.Add" Color="Color.Primary" OnClick="AddValue" />
        </MudStack>
    </MudItem>
</MudGrid>

@code {
    [Parameter] public Condition Condition { get; set; }

    void AddValue()
    {
        Condition.Values.Add(string.Empty);
    }

    void RemoveValue(int index)
    {
        if (index >= 0 && index < Condition.Values.Count)
        {
            Condition.Values.RemoveAt(index);
        }
    }
}
