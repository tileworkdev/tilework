@inject LoadBalancerListViewModel ViewModel
@inject NavigationManager NavigationManager
@using Tilework.LoadBalancing.Models
@page "/lb/loadbalancers"

<MudBreadcrumbs Items="_items" Separator=">"></MudBreadcrumbs>

<MudTable Outlined="true" Items="ViewModel.Balancers" Hover="true">
    <ToolBarContent>
        <MudText Typo="Typo.h6">Load balancers</MudText>
        <MudSpacer />
        <MudButton Variant="Variant.Filled" DisableElevation="true" Color="Color.Primary" Href="/lb/loadbalancers/new">
            Create new
        </MudButton>
    </ToolBarContent>
    <HeaderContent>
        <MudTh>Name</MudTh>
        <MudTh>Type</MudTh>
        <MudTh>Port</MudTh>
        <MudTh>Status</MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="Name"><MudLink Href="@DetailLink(context.Id)">@context.Name</MudLink></MudTd>
        <MudTd DataLabel="Type">@context.Type</MudTd>
        <MudTd DataLabel="Port">@context.Port</MudTd>
        <MudTd DataLabel="Status">
            @if (context.Enabled)
            {
                <MudChip Size="Size.Small" Color="Color.Success" Text="Enabled" />
            }
            else
            {
                <MudChip Size="Size.Small" Color="Color.Error" Text="Disabled" />
            }
        </MudTd>
    </RowTemplate>
</MudTable>

@code {
    private List<BreadcrumbItem> _items = new List<BreadcrumbItem>
    {
        new BreadcrumbItem("Home", href: "/", icon: Icons.Material.Filled.Home),
        new BreadcrumbItem("Load balancers", href: "/lb/loadbalancers/", disabled: true, icon: Icons.Material.Filled.AltRoute),
    };

    protected override async Task OnInitializedAsync()
    {
        await ViewModel.Initialize();
    }

    private string DetailLink(Guid Id)
    {
        return $"/lb/loadbalancers/{Id.ToString()}";
    }
}    
